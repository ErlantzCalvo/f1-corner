---
import NextRace from "../components/NextRaceInfo.astro";
import RaceInfo from "../components/RaceResults.astro";
import Layout from "../layouts/Layout.astro";
import { getNextRaceData } from "../api/schedule";
import StructuredData from "../components/StructuredData.astro";

const nextRaceData = await getNextRaceData();
const race = nextRaceData?.Races?.[0];

const structuredData = race
  ? {
      "@context": "https://schema.org",
      "@type": "SportsEvent",
      name: race.raceName,
      startDate: `${race.date}T${race.time}`,
      location: {
        "@type": "Place",
        name: race.Circuit.circuitName,
        address: {
          "@type": "PostalAddress",
          addressLocality: race.Circuit.Location.locality,
          addressCountry: race.Circuit.Location.country,
        },
      },
    }
  : null;
---

<Layout
  title="Home"
  description="Follow the latest Formula 1 standings, race results, and championship rankings. See the countdown to the next F1 race and results from the last Grand Prix."
>
  {structuredData && <StructuredData data={structuredData} />}
  <section>
    <h2>Next Race</h2>
    <NextRace daysText="days" />
  </section>
  <RaceInfo race="last" />
</Layout>

<style>
  section {
    border-radius: 10px;
    margin-bottom: 15px;
    box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
  }

  html.dark section {
    box-shadow:
      rgba(255, 255, 255, 0.35) 0px 0.0625em 0.625em,
      rgba(255, 255, 255, 0.35) 0px 0.125em 0.5em,
      rgba(255, 255, 255, 0.1) 0px 0px 0px 1px inset;
  }
</style>
